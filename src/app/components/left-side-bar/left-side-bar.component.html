<div class="sidebar-container" [class.collapsed]="!isOpen">
  <!-- Collapsed State Button -->
  <button *ngIf="!isOpen" class="open-btn" (click)="toggleSidebar()" aria-label="Open sidebar">
    <img src="/icons/left-panel-close.svg" alt="Open" class="open-icon">
  </button>

  <div class="sidebar-content" *ngIf="isOpen">
    <!-- Header -->
    <div class="sidebar-header">
      <div class="header-info">
        <h2 class="strategy-title">AB's US Equity Strategy</h2>
        <p class="strategy-subtitle">AB Global Core</p>
      </div>
      <button class="close-btn" (click)="toggleSidebar()" aria-label="Close sidebar">
        <img src="/icons/right-panel-close.svg" alt="Close" class="close-icon">
      </button>
    </div>

    <!-- Workflow Overview -->
    <div class="workflow-section">
      <div class="workflow-content">
        <div class="workflow-steps">
          <div *ngFor="let step of workflowSteps; let i = index" class="workflow-item">
            <div class="step-row">
              <div class="step-indicator">
                <img *ngIf="step.isCompleted" src="/icons/green-check-mark-icon.svg" alt="Check" class="check-icon">
                <img *ngIf="step.isActive" src="/icons/active-circle-icon.svg" alt="Check" class="active-icon">
                <img *ngIf="!step.isActive && !step.isCompleted" src="/icons/inactive-circle-icon.svg" alt="Check" class="inactive-icon">
              </div>
              <p class="step-name" [class.active]="step.isActive">{{ step.name }}</p>
            </div>
            <div *ngIf="i < workflowSteps.length - 1" class="step-connector"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Chapters/Sources Section -->
    <div class="chapters-section">
      <!-- Tabs -->
      <div class="tabs">
        <button 
          class="tab" 
          [class.active]="activeTab === 'chapters'"
          (click)="toggleTab('chapters')">
          <img src="/icons/book-icon.svg" alt="Chapters" class="tab-icon" [class.active-icon]="activeTab === 'chapters'">
          <span>Chapters</span>
        </button>
        <button 
          class="tab" 
          [class.active]="activeTab === 'sources'"
          (click)="toggleTab('sources')">
          <img src="/icons/book-icon.svg" alt="Sources" class="tab-icon" [class.active-icon]="activeTab === 'sources'">
          <span>Sources({{ sourcesCount }})</span>
        </button>
      </div>

      <!-- Chapters List -->
      <div class="chapters-list" *ngIf="activeTab === 'chapters'">
        <div *ngFor="let chapter of chapters; let last = last" class="chapter-item">
          <div class="chapter-header" (click)="toggleChapter(chapter)">
            <div class="chapter-title-section">
              <ol class="chapter-number" [start]="chapter.number">
                <li [class.bold]="chapter.expanded">{{ chapter.name }}</li>
              </ol>
            </div>
            <div class="progress-dots" *ngIf="chapter.progress > 0">
              <span 
                *ngFor="let dot of getProgressDots(chapter.progress)" 
                class="dot"
                [class.filled]="dot === 1"
                [class.partial]="dot === 0.5">
              </span>
            </div>
          </div>

          <!-- Subsections -->
          <div class="subsections" *ngIf="chapter.expanded && chapter.subsections.length > 0">
            <div *ngFor="let subsection of chapter.subsections" class="subsection-item">
              <div class="subsection-content">
                <img src="/icons/arrow-top-left.svg" alt="Arrow" class="arrow-icon">
                <span class="subsection-name">{{ subsection.name }}</span>
              </div>
              <div class="subsection-status">
                <img *ngIf="subsection.status === 'completed'"  src="/icons/green-check-mark-icon.svg" alt="In Progress" class="status-icon completed">
                <img *ngIf="subsection.status === 'in-progress'"  src="/icons/active-circle-icon.svg" alt="In Progress" class="status-icon in-progress">
                <img *ngIf="subsection.status === 'not-started'"  src="/icons/inactive-circle-icon.svg" alt="In Progress" class="status-icon not-started">
              </div>
            </div>
          </div>

          <div class="chapter-divider" *ngIf="!last"></div>
        </div>
      </div>

      <!-- Sources View (placeholder) -->
      <div class="sources-list" *ngIf="activeTab === 'sources'">
        <p class="placeholder-text">Sources content will appear here</p>
      </div>
    </div>
  </div>
</div>
